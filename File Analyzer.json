{"blocks":[{"id":"6F721D9A-FC3A-4959-9997-B481E071441A","type":"StartBlock","disabled":false,"name":"Start","displayName":"Start","comment":"","childId":"B21FAA5A-8EAC-4932-BEFD-DEE09624EA41","inputs":[{"id":"run_mode","value":"manual","type":"select","structure":{}}],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":0,"y":0},{"id":"D112ED51-FD93-4D23-ABCB-6DC5C5C6280D","type":"ForEachBlock","disabled":false,"name":"loop","displayName":"Loop","comment":"","childId":null,"inputs":[{"id":"input","value":"{$.GetAppInformation.lineage}","type":"string","structure":[]}],"settings":[{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":240,"y":560,"loopBlockId":"5F6DDFC5-2664-47D0-8AC7-3840758C426F"},{"id":"5F6DDFC5-2664-47D0-8AC7-3840758C426F","type":"VariableBlock","disabled":false,"name":"LoadScript","displayName":"Variable - LoadScript","comment":"","childId":null,"inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":360,"y":780,"variableGuid":"14307F90-5DE9-45C9-A2BA-632D1A0CEDD9","operations":[{"id":"append","key":"86E04552-05FE-473C-8A12-52E7E9D21705","name":"Append to { variable }","value":"{text: '{$.listSpaces.item.id}^{$.listSpaces.item.name}^{$.listSpaces.item.type}|{$.listSpaces.item.id}^{$.GetAppInformation.info.attributes.id}^{$.listApps.item.name}|{$.loop.item.discriminator}'}{linebreak}"}]},{"id":"643591A8-D2F2-4224-A00E-0A71AD47CE60","type":"EndpointBlock","disabled":false,"name":"listApps","displayName":"Qlik Cloud Services - List Apps","comment":"","childId":null,"inputs":[{"id":"8cd8db50-107b-11ec-8082-edc45dd151ef","value":null,"type":"select","structure":[]},{"id":"8ce4fad0-107b-11ec-a6ac-2bd407ad134b","value":"{$.listSpaces.item.id}","type":"string","structure":[]}],"settings":[{"id":"maxitemcount","value":"","type":"string","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"cache","value":"0","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":0,"y":280,"loopBlockId":"AA86051C-34B6-4985-A24C-3C6D4DD7C6F6","datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"8cc63340-107b-11ec-ab5d-f9b221ed2dc5","endpoint_role":"list"},{"id":"08D5B09A-0AC0-4D7C-BA36-75583EA734A8","type":"EndpointBlock","disabled":false,"name":"listSpaces","displayName":"Qlik Cloud Services - List Spaces","comment":"","childId":"4316C433-AD4B-47A9-986A-0EFDFF5B1773","inputs":[],"settings":[{"id":"maxitemcount","value":"","type":"string","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"cache","value":"0","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":0,"y":360,"loopBlockId":"643591A8-D2F2-4224-A00E-0A71AD47CE60","datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"42815920-5f18-11eb-8321-91b1587b6c06","endpoint_role":"list"},{"id":"8BA59110-E8F9-4710-B13F-57968A97BCF7","type":"CallUrlBlock","disabled":false,"name":"callURL","displayName":"Call URL","comment":"","childId":"5B16AB57-93E9-44DB-B577-BEF92DC2B9CE","inputs":[{"id":"url","value":"https://raw.githubusercontent.com/KarlRikardLarsson/QVDanalyzer/refs/heads/main/App_template","type":"string","structure":[]},{"id":"method","value":"GET","type":"select","structure":[]},{"id":"timeout","value":"","type":"string","structure":[]},{"id":"params","value":null,"type":"object","mode":"keyValue","structure":[]},{"id":"headers","value":null,"type":"object","mode":"keyValue","structure":[]},{"id":"encoding","value":"","type":"string","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"full_response","value":null,"type":"checkbox","structure":[]},{"id":"capitalize_headers","value":true,"type":"checkbox","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":0,"y":2680},{"id":"E503CDA1-1C9C-4F96-A7F5-680B35960BB2","type":"VariableBlock","disabled":false,"name":"LoadScript","displayName":"Variable - LoadScript","comment":"Create a Variable to hold the Load Script.","childId":"F99DC5F9-B7ED-40B1-A7A7-4BC3E006D87F","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":0,"y":120,"variableGuid":"14307F90-5DE9-45C9-A2BA-632D1A0CEDD9","operations":[{"id":"set_value","key":"D37B52C4-4B14-45E6-9ED8-2E550D825E0B","name":"Set value of { variable }","value":"///$tab Variables\nSET ThousandSep=',';\r\nSET DecimalSep='.';\r\nSET MoneyThousandSep=',';\r\nSET MoneyDecimalSep='.';\r\nSET MoneyFormat='$#,##0.00;-$#,##0.00';\r\nSET TimeFormat='h:mm:ss TT';\r\nSET DateFormat='M/D/YYYY';\r\nSET TimestampFormat='M/D/YYYY h:mm:ss[.fff] TT';\r\nSET FirstWeekDay=6;\r\nSET BrokenWeeks=1;\r\nSET ReferenceDay=0;\r\nSET FirstMonthOfYear=1;\r\nSET CollationLocale='en-US';\r\nSET CreateSearchIndexOnReload=1;\r\nSET MonthNames='Jan;Feb;Mar;Apr;May;Jun;Jul;Aug;Sep;Oct;Nov;Dec';\r\nSET LongMonthNames='January;February;March;April;May;June;July;August;September;October;November;December';\r\nSET DayNames='Mon;Tue;Wed;Thu;Fri;Sat;Sun';\r\nSET LongDayNames='Monday;Tuesday;Wednesday;Thursday;Friday;Saturday;Sunday';\r\nSET NumericalAbbreviation='3:k;6:M;9:G;12:T;15:P;18:E;21:Z;24:Y;-3:m;-6:Î¼;-9:n;-12:p;-15:f;-18:a;-21:z;-24:y';\nSET NullInterpret ='';\nLET NullValue=;\nSET HidePrefix='_';\n{linebreak}"}]},{"id":"F99DC5F9-B7ED-40B1-A7A7-4BC3E006D87F","type":"VariableBlock","disabled":false,"name":"LoadScript","displayName":"Variable - LoadScript","comment":"Begin the Inline Fields load script.","childId":"08D5B09A-0AC0-4D7C-BA36-75583EA734A8","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":0,"y":360,"variableGuid":"14307F90-5DE9-45C9-A2BA-632D1A0CEDD9","operations":[{"id":"append","key":"8D255A80-E10D-4449-A855-80BB6A3F10FB","name":"Append to { variable }","value":"///$tab Used QVDs\nUsed_QVDs:\nLOAD\n*,\n1 AS FieldCounter\nINLINE `\nSpace|App|Details\n{linebreak}{linebreak}"}]},{"id":"AA86051C-34B6-4985-A24C-3C6D4DD7C6F6","type":"SnippetBlock","disabled":false,"name":"GetAppInformation","displayName":"Qlik Cloud Services - Get App Information","comment":"","childId":"D112ED51-FD93-4D23-ABCB-6DC5C5C6280D","inputs":[{"id":"d3acbdc0-a8d2-11eb-8827-056900eab788","value":"{$.listApps.item.id}","type":"string","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-241,"y":690,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","snippet_guid":"d3a8d4f0-a8d2-11eb-a81d-ffabb68491fb"},{"id":"2CF63D63-3A4F-4D90-A6B4-A47F5F3C40C2","type":"EndpointBlock","disabled":false,"name":"listDataFiles","displayName":"Qlik Cloud Services - List Data Files","comment":"","childId":null,"inputs":[{"id":"44da6400-f548-11ed-b69c-cd1f00885bf2","value":null,"type":"select","structure":[]},{"id":"5872f750-f548-11ed-8f4f-e153b2253f62","value":null,"type":"string","structure":[]},{"id":"bc104e50-f548-11ed-86e3-85b622a1703f","value":"{$.filterList.item.id}","type":"string","structure":[]},{"id":"eb7555a0-f548-11ed-b6a4-733648ff08a4","value":null,"type":"string","structure":[]},{"id":"00770740-f549-11ed-b0fa-afe239113bad","value":null,"type":"string","structure":[]}],"settings":[{"id":"maxitemcount","value":"","type":"string","structure":[]},{"id":"blendr_on_error","value":"warning","type":"select","displayValue":"Warning - Continue Automation and report errors","structure":[]},{"id":"cache","value":"0","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":120,"y":1520,"loopBlockId":"07B0337E-5D0B-4AFE-8014-9F74CE5942F4","datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"1250db90-f548-11ed-bb5c-31311462577f","endpoint_role":"list"},{"id":"4316C433-AD4B-47A9-986A-0EFDFF5B1773","type":"EndpointBlock","disabled":false,"name":"listDataConnections","displayName":"Qlik Cloud Services - List Data Connections","comment":"","childId":"ADA3DEEE-A40D-4276-B3E0-F6EA8BE71FD8","inputs":[],"settings":[{"id":"maxitemcount","value":"","type":"string","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"cache","value":"0","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":true}],"x":0,"y":1180,"loopBlockId":null,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"2c30aa50-4f34-11eb-9ed0-85d3ebe3b610","endpoint_role":"list"},{"id":"142647DB-4ECB-4B75-8591-83ED1E7F5DA1","type":"FilterListBlock","disabled":false,"name":"filterList","displayName":"Filter over Qlik Cloud Services - List Data Connections - Filter List","comment":"","childId":"96155885-F74D-4946-901C-A59FE70EA0F6","inputs":[{"id":"list","value":"{ $.listDataConnections }","type":"string","structure":[]},{"id":"conditions","value":{"mode":"all","conditions":[{"input1":"qName","input2":"DataFiles","operator":"contain"},{"input1":"space","input2":null,"operator":"notEmpty"}]},"type":"custom","structure":[]}],"settings":[{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":0,"y":2040,"loopBlockId":"83557704-D9C4-40CC-80A1-83A8C16FC4C5"},{"id":"07B0337E-5D0B-4AFE-8014-9F74CE5942F4","type":"VariableBlock","disabled":false,"name":"LoadScript","displayName":"Variable - LoadScript","comment":"","childId":null,"inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-282,"y":297,"variableGuid":"14307F90-5DE9-45C9-A2BA-632D1A0CEDD9","operations":[{"id":"append","key":"A936284E-6DB1-4B17-8344-855C7A652BCC","name":"Append to { variable }","value":"{text: '{$.listDataFiles.item.spaceId}^{$.getSpace.name}|{$.listDataFiles.item.name}|{$.listDataFiles.item.createdDate}|{$.listDataFiles.item.modifiedDate}|{$.listDataFiles.item.size}|'}{linebreak}"}]},{"id":"ADA3DEEE-A40D-4276-B3E0-F6EA8BE71FD8","type":"VariableBlock","disabled":false,"name":"LoadScript","displayName":"Variable - LoadScript","comment":"","childId":"142647DB-4ECB-4B75-8591-83ED1E7F5DA1","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":0,"y":1300,"variableGuid":"14307F90-5DE9-45C9-A2BA-632D1A0CEDD9","operations":[{"id":"append","key":"03C1A7A5-8A7E-4ECD-8FB7-65F0431DA08A","name":"Append to { variable }","value":"` (delimiter is '|');\n{linebreak}{linebreak}"},{"id":"append","key":"16E3F654-FA8C-42C5-B29F-75656111A327","name":"Append to { variable }","value":"///$tab All QVDs\nQvds:\nLOAD\n*,\n1 AS QVDcounter\nINLINE `\nSpace|Datafile|Creation day|Last modified date|size\n{linebreak}"}]},{"id":"EF2B9AB3-9EEC-4B39-ADB2-53E35F7E4E84","type":"SnippetBlock","disabled":false,"name":"ListSheets","displayName":"Qlik Cloud Services - List Sheets","comment":"","childId":"EB3EE85B-6E46-4B0E-8C83-6185459EC640","inputs":[{"id":"e9e6c2e0-1fa5-11eb-b780-556801493651","value":"{$.importAppFromBase64EncodedFile.attributes.id}","type":"string","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":0,"y":2500,"loopBlockId":"A1B2508F-89F7-45EA-9E87-E83249BCC116","datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","snippet_guid":"c3eca7d0-188a-11eb-a972-933bbe8b97a3"},{"id":"A1B2508F-89F7-45EA-9E87-E83249BCC116","type":"SnippetBlock","disabled":false,"name":"publishSheet","displayName":"Qlik Cloud Services - Publish Sheet","comment":"","childId":null,"inputs":[{"id":"8e2482f0-0fbc-11ec-b756-9dc10a0d8466","value":"{$.importAppFromBase64EncodedFile.attributes.id}","type":"string","structure":[]},{"id":"e8242e20-0fbc-11ec-bb18-21344898a69e","value":"{$.ListSheets.item.qInfo.qId}","type":"string","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-262,"y":1942,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","snippet_guid":"8e1ef9a0-0fbc-11ec-857c-57f1f416cbef"},{"id":"EB3EE85B-6E46-4B0E-8C83-6185459EC640","type":"EndpointBlock","disabled":false,"name":"setLoadScript","displayName":"Qlik Cloud Services - Set Load Script","comment":"","childId":"122239EF-5CD8-4D89-BAE4-81A59FF4201A","inputs":[{"id":"917b8660-a12b-11ed-873f-fd156b9f0ebb","value":"{$.importAppFromBase64EncodedFile.attributes.id}","type":"string","structure":[]},{"id":"d31e0400-a12c-11ed-b43b-29c58fb1f869","value":"{$.LoadScript}","type":"string","structure":[]},{"id":"0da08560-a12d-11ed-92bf-6146d9e01e80","value":null,"type":"string","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-236,"y":2321,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"916661a0-a12b-11ed-882f-fb01a4e99b0a","endpoint_role":"create"},{"id":"122239EF-5CD8-4D89-BAE4-81A59FF4201A","type":"SnippetBlock","disabled":false,"name":"saveApp","displayName":"Qlik Cloud Services - Save App","comment":"","childId":"E24C2817-30C2-4A02-883D-DBF6B3373B59","inputs":[{"id":"e4c96750-018f-11ec-9324-452b72262f88","value":"{$.importAppFromBase64EncodedFile.attributes.id}","type":"string","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-319,"y":2187,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","snippet_guid":"e4c44ca0-018f-11ec-9e3c-1d9f5d508976"},{"id":"E24C2817-30C2-4A02-883D-DBF6B3373B59","type":"SnippetBlock","disabled":false,"name":"DoReload","displayName":"Qlik Cloud Services - Do Reload","comment":"","childId":"034F43B3-96DE-4163-9937-5C806A7B289D","inputs":[{"id":"29603390-e716-11ea-9e37-05e08ee32111","value":"{$.importAppFromBase64EncodedFile.attributes.id}","type":"string","structure":[]},{"id":"2ac9eef0-a677-11eb-aacc-8b755d0fe484","value":null,"type":"select","structure":[]},{"id":"6892c0c0-c795-11eb-9860-9dc8cb705e25","value":null,"type":"select","structure":[]},{"id":"ecebf340-c797-11eb-8671-53658babb1a1","value":null,"type":"select","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-252,"y":2184,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","snippet_guid":"b5dbb7a0-e715-11ea-b2bf-43bb35adee19"},{"id":"034F43B3-96DE-4163-9937-5C806A7B289D","type":"SnippetBlock","disabled":false,"name":"saveApp2","displayName":"Qlik Cloud Services - Save App 2","comment":"","childId":null,"inputs":[{"id":"e4c96750-018f-11ec-9324-452b72262f88","value":"{$.importAppFromBase64EncodedFile.attributes.id}","type":"string","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-282,"y":2190,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","snippet_guid":"e4c44ca0-018f-11ec-9e3c-1d9f5d508976"},{"id":"96155885-F74D-4946-901C-A59FE70EA0F6","type":"VariableBlock","disabled":false,"name":"LoadScript","displayName":"Variable - LoadScript","comment":"","childId":"0DC36D2A-46ED-419E-B5BB-5D2E5704DC64","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":0,"y":1820,"variableGuid":"14307F90-5DE9-45C9-A2BA-632D1A0CEDD9","operations":[{"id":"append","key":"A194C887-93A1-4212-B1C4-96D226C590CB","name":"Append to { variable }","value":"` (delimiter is '|');"}]},{"id":"0DC36D2A-46ED-419E-B5BB-5D2E5704DC64","type":"VariableBlock","disabled":false,"name":"LoadScript","displayName":"Variable - LoadScript","comment":"","childId":"8BA59110-E8F9-4710-B13F-57968A97BCF7","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-304,"y":2239,"variableGuid":"14307F90-5DE9-45C9-A2BA-632D1A0CEDD9","operations":[{"id":"append","key":"A3945416-B2C3-4FAA-893F-B7248124BBEA","name":"Append to { variable }","value":"///$tab Model\n//--- App Table\nAppTable:\nLOAD DISTINCT\nSubField(App, '^', 2) as %Key_AppID,\nSubField(App, '^', 1) as SpaceID,\nSubField(App, '^', 3) as AppName,\nlower(SubField(Space, '^', 2)) as SpaceName,\nSubField(Space, '^', 3) as SpaceType\nResident Used_QVDs;\n{linebreak}\n//--- Map\nMap_SpaceID:\nMAPPING LOAD\nLower(SubField(Space, '^', 2)) & ':datafiles' as SpaceName,\nSubField(Space, '^', 1) as SpaceID\nResident Qvds;\nUnusedSpace:\nMAPPING Load\nSpace,\n1\nRESIDENT Used_QVDs;\nMap_SpaceName:\nMAPPING LOAD\nSubField(Space, '^', 1) as SpaceID,\nLower(SubField(Space, '^', 2)) as SpaceName\nResident Qvds;\nMap_SpaceType:\nMAPPING LOAD\nSubField(Space, '^', 1) as SpaceID,\nSubField(Space, '^', 3) as SpaceType\nResident Used_QVDs;\n{linebreak}\n// ----\nConcatenate(AppTable)\nLoad Distinct\nSubField(Space, '^', 1) as SpaceID,\nSubField(Space, '^', 2) as SpaceName,\nSubField(Space, '^', 3) as SpaceType\nRESIDENT Qvds\nWHERE ApplyMap('UnusedSpace',Space)<>1;\n{linebreak}\n//--- Operations Table\nOperationsTable:\nLOAD*,\nreplace(Tmp_StoreReadSpace,':datafiles','') AS StoreReadSpace,\nIf(OperationType = 'STORE' OR OperationType = 'READ QVD', Applymap('Map_SpaceID', Tmp_StoreReadSpace) , 'Resident.') & '^' & FileNameOrTable & '.qvd' AS %Key_QVD;\nLOAD\nSubField(App, '^', 2) as %Key_AppID, // Link to App table\nSubField(App, '^', 3) as OperationAppName, // App performing the operation (read or store)\nIf(WildMatch(Details, '*STORE*'), 'STORE',\nIf(WildMatch(Details, '*Resident*'), 'RESIDENT',\nIf(WildMatch(Details, '*lib://*.qvd*'), 'READ QVD',\nIf(WildMatch(Details, '*INLINE*'), 'INLINE LOAD',\nIf(WildMatch(Details, '*AUTOGENERATE*'), 'AUTOGENERATE LOAD', 'OTHER'))))) as OperationType, // Identify operation type\nDetails,\nIf(WildMatch(Details, '*STORE*'), //lib://2.2. Shared Transform Prod:DataFiles/StandardappEkonomi/egbs.OutputFiles.qvd\nLower(SubField(TextBetween(Details, '/', '.qvd'), '/', -1))\n,\nIf(WildMatch(Details, '*lib://*.qvd*'),\nLower(SubField(TextBetween(Details, '/', '.qvd'), '/', -1)),\nIf(WildMatch(Details, '*RESIDENT*'),\nReplace(SubField(Details, ' ', 2), ';', ''),\nSubField(Details, ';', 1)))) as FileNameOrTable, // Extract file/table name\n\n// Tmp_StoreReadSpace Extraction\nIf( WildMatch(Details, '*lib://:datafiles/*'),\nLower(SubField(Space, '^', 2)) &':datafiles',\nIf(WildMatch(Details, '*STORE*') and WildMatch(Details, '*lib://:datafiles/*'),\nLower(SubField(Space, '^', 2))&':datafiles',\nIf(WildMatch(Details, '*READ QVD*'),\nLower(SubField(TextBetween(Details, '/', '.qvd'), '/', -1)),\n\nIf(WildMatch(Details, '*lib://*.qvd*'),\nLower(TextBetween(Details, 'lib://', '/')))))) AS Tmp_StoreReadSpace\n\nResident Used_QVDs;\n{linebreak}\n//--- QVD Table (Metadata of QVD files)\nQVDTable:\nLOAD\nSubField(Space, '^', 1) & '^' & IF(Index(Datafile, '/') > 0,\nLower(SubField(Datafile, '/',-1)),\nLower(SubField(Datafile, '.qvd', 1))&'.qvd') as %Key_QVD, // Unique key for QVD file\nIF(Index(Datafile, '/') > 0,\ncapitalize (SubField(Datafile, '/',-1)),\ncapitalize (SubField(Datafile, '.qvd', 1))) as QVDName,\n[Creation day] as QVD_CreationDay,\n[Last modified date] as QVD_LastModifiedDate,\nsize as QVDSize\nResident Qvds;\n{linebreak}\n//--- Left join QVDTable with OperationsTable (for QVDs that are READ)\nLeft Join (QVDTable)\nLOAD\n%Key_QVD,\n'Used' as QVDUsageFlag\nResident OperationsTable\nWHERE OperationType ='READ QVD';\n{linebreak}\n//--- Unused QVDs Table\nQVDs:\nNOCONCATENATE\nLOAD DISTINCT\n%Key_QVD,\nQVDName,\nQVD_CreationDay,\nQVD_LastModifiedDate,\nQVDSize,\n0 AS Lineage,\n1 AS QVDcounter\nResident QVDTable\nWhere IsNull(QVDUsageFlag);\nConcatenate(QVDs)\nLOAD DISTINCT\n%Key_QVD,\nQVDName,\nQVD_CreationDay,\nQVD_LastModifiedDate,\nQVDSize,\n1 AS Lineage,\n1 AS QVDcounter\nResident QVDTable\nWhere not IsNull(QVDUsageFlag);\nMap_QVDs:\nMapping LOAD\n%Key_QVD,\n1\nREsident QVDs;\nConcatenate(QVDs)\nLoad\nSubField(Space, '^', 1) & '^' & IF(Index(Datafile, '/') > 0,\nLower(SubField(Datafile, '/',-1)),\nLower(SubField(Datafile, '.qvd', 1))&'.qvd') as %Key_QVD, // Unique key for QVD file\nIF(Index(Datafile, '/') > 0,\ncapitalize (SubField(Datafile, '/',-1)),\ncapitalize (SubField(Datafile, '.qvd', 1))) as QVDName,\n[Creation day] as QVD_CreationDay,\n[Last modified date] as QVD_LastModifiedDate,\nsize as QVDSize,\n0 AS Lineage,\n1 AS QVDcounter\nRESIDENT Qvds\nWHERE ApplyMap('Map_QVDs', SubField(Space, '^', 1) & '^' & IF(Index(Datafile, '/') > 0,\nLower(SubField(Datafile, '/',-1)),\nLower(SubField(Datafile, '.qvd', 1))&'.qvd'))<>1;\n{linebreak}\nMapReadApp:\nLOAD\n%Key_QVD,\nOperationAppName as ReadAppName\nResident OperationsTable\nWHERE OperationType ='READ QVD';\n{linebreak}\nRename Table OperationsTable to TMP;\nOperationsTable:\nNoConcatenate\nLOAD*\nRESIDENT TMP\nWHERE OperationType ='STORE' OR 'RESIDENT' OR 'READ QVD';\nDROP TABLE TMP;\n{linebreak}\nUnusedQVD:\nMAPPING Load\n[%Key_QVD],\n1\nRESIDENT OperationsTable;\n{linebreak}\nConcatenate(OperationsTable)\nLOAD*,\nReplace(Tmp_StoreReadSpace,':datafiles','') AS StoreReadSpace;\nLOAD\n%Key_QVD,\nSubField(%Key_QVD, '^', 1) AS [%Key_AppID], // First part (AppID)\n'None' AS [Details],\nApplyMap('Map_SpaceName', SubField(%Key_QVD, '^', 1)) AS [Tmp_StoreReadSpace], // Map using first part (AppID)\n'NONE' AS [OperationType],\nLower(QVDName) AS FileNameOrTable\nResident QVDs\nWHERE ApplyMap('UnusedQVD', %Key_QVD) <> 1;\n{linebreak}\nConcatenate(AppTable)\nTEST:\nLOAD\nSubField(%Key_QVD,'^',1) AS [%Key_AppID],\nSubField(%Key_QVD,'^',1) AS [SpaceID],\nApplyMap('Map_SpaceName',SubField(%Key_QVD,'^',1)) AS [SpaceName],\nApplyMap('Map_SpaceType',SubField(%Key_QVD,'^',1)) AS [SpaceType],\n'None' AS AppName\nResident\nQVDs WHERE ApplyMap('UnusedQVD',%Key_QVD ) <>1;\n{linebreak}\nLEFT JOIN (AppTable)\nLoad DISTINCT\n[%Key_AppID],\nDual(AppName,AutoNumber(%Key_AppID)) AS AppNameUnique\nResident AppTable;\n{linebreak}\nDROP Fields\nOperationAppName\n,Details\n,QVDUsageFlag\n,Tmp_StoreReadSpace\n;\n{linebreak}\nDROP TABLES\nQVDTable\n,Qvds\n,Used_QVDs;\n{linebreak}\nTenant:\nLOAD\n'$(vTenant)' AS Tenant\nAutoGenerate 1;\n\nAUTONUMBER '%*';"}]},{"id":"83557704-D9C4-40CC-80A1-83A8C16FC4C5","type":"EndpointBlock","disabled":false,"name":"getSpace","displayName":"Qlik Cloud Services - Get Space","comment":"","childId":"2CF63D63-3A4F-4D90-A6B4-A47F5F3C40C2","inputs":[{"id":"92f7bcd0-6d2d-11eb-9088-69419de8f253","value":"{$.filterList.item.space}","type":"string","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"cache","value":"0","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-225,"y":1900,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"92afefd0-6d2d-11eb-aee2-055653605a8e","endpoint_role":"get"},{"id":"FE5F5C7C-5F55-4854-83F3-855C3EBB1BFF","type":"FormBlock","disabled":false,"name":"inputs","displayName":"Inputs","comment":"User Inputs.","childId":"E503CDA1-1C9C-4F96-A7F5-680B35960BB2","inputs":[],"settings":[{"id":"persist_data","value":"no","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":364,"y":138,"form":[{"id":"inputs-input-0","label":"Output App Name","helpText":"The desired name of the output app. If this is left blank, the app will be named 'QVD Lineage'.","type":"input","values":null,"isRequired":false,"options":{},"order":0},{"id":"inputs-input-1","label":"Output App Space Id","helpText":"The Id of the space to place the output app into. If this is left blank, the app will be placed in the executing user's personal space.","type":"input","values":null,"isRequired":false,"options":{},"order":1}],"persistData":"no"},{"id":"B21FAA5A-8EAC-4932-BEFD-DEE09624EA41","type":"ShowBlock","disabled":false,"name":"output","displayName":"Output","comment":"","childId":"FE5F5C7C-5F55-4854-83F3-855C3EBB1BFF","inputs":[{"id":"input","value":"### This automation creates a application, please choose the applications name and space.","type":"string","structure":[]}],"settings":[{"id":"display_mode","value":"add","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-374,"y":330},{"id":"5B16AB57-93E9-44DB-B577-BEF92DC2B9CE","type":"EndpointBlock","disabled":false,"name":"importAppFromBase64EncodedFile","displayName":"Qlik Cloud Services - Import App From Base 64 Encoded File","comment":"","childId":"EF2B9AB3-9EEC-4B39-ADB2-53E35F7E4E84","inputs":[{"id":"09b520a0-7aa4-11eb-8143-cde65e595ead","value":"{$.callURL}","type":"string","structure":[]},{"id":"19661000-67b1-11eb-b4c6-fb30d89c586f","value":"{if: {$.inputs.'Output App Name'} empty , 'QVD Analyzer', $.inputs.'Output App Name'}","type":"string","structure":[]},{"id":"197675a0-67b1-11eb-b6f6-9ff3bc51ddbf","value":"{if: {$.inputs.'Output App Space Id'} empty , , $.inputs.'Output App Space Id'}","type":"string","structure":[]},{"id":"4d3a3300-67b1-11eb-99af-3d55175faa9a","value":"5a406580-67b1-11eb-bad4-5f783555fa1b","type":"select","displayValue":"NEW","structure":[]},{"id":"ac4b58f0-67b1-11eb-8126-89d0cf328adb","value":null,"type":"string","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":311,"y":2280,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"194b9430-67b1-11eb-9e04-6dbde84bea83","endpoint_role":"create"}],"variables":[{"guid":"B5AEE197-8737-4BAD-8AE7-C5CB75872487","name":"Data","type":"list"},{"guid":"B5A48723-CE8C-42B4-B14E-D0DF40D4BA01","name":"URL","type":"string"},{"guid":"14307F90-5DE9-45C9-A2BA-632D1A0CEDD9","name":"LoadScript","type":"string"},{"guid":"5812F497-C131-4BF2-B314-9E4C7C153483","name":"LoadScriptAllQVD","type":"string"},{"guid":"1524AF8B-5751-46F6-ABCA-BA0839C262F2","name":"Test","type":"string"},{"guid":"1158ABE2-A00C-4C24-90AC-E183672BDCC1","name":"Text","type":"string"}]}